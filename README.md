# API `/api/{任意}/` 使用说明

## 接口描述
该接口用于接收用户请求，将 `token` 存入 Redis 并原封不动地转发请求到配置文件中指定的后端 URL。同时会校验 `token` 的使用时间，如果超出配置的 `InvalidTime` 将返回提示信息。

这个API路径 {任意} 不校验。用户请求过来是什么就是什么直接转发给后端。例如用户请求了`/api/1234a/token=xxx`那么校验token并且转发到后端请求`{url}/api/1234a/token=xxx`

---

## 请求方式

```
GET /api/{任意}/
```

### 请求参数

| 参数 | 类型 | 是否必填 | 说明 |
|------|------|----------|------|
| token | string | 必填 | 用户的唯一 token |
| flag | string | 可选 | 附加参数，可原样转发 |
| 其他 | string | 可选 | 所有额外参数会原封不动转发 |

示例请求：

```
/api/{任意}/token=6998377b2f727ff6bdb697cc29f80ab8&flag=clashmeta
/api/{任意}/token=6998377b2f727ff6bdb697cc29f80ab8
````

---

## 功能说明

1. **存储 token**  
   - 接收到请求后，将 `token` 存入 Redis。
   - 使用 Redis 存储的同时记录时间戳，用于后续校验。

2. **转发请求**  
   - 原请求参数将不做修改直接转发到配置文件中指定的 `url`。

3. **token 使用时间校验**  
   - 每次请求时检查 token 上次使用时间。
   - 如果距离上次使用超过配置的 `InvalidTime`，返回 JSON：

```json
{
  "message": "Token使用时间超时"
}
````

4. **正常转发**

    * 如果 token 在有效时间内，接口将继续将请求转发到后端并返回后端响应。

---
